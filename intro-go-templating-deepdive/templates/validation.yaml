{{- /* validation can be done in a single yaml file, but NOT in .tpl file */ -}}
{{- if and .Values.securityContext .Values.securityContext.enabled -}}
{{- $_ := required "securityContext.runAsUser is required when setting securityContext and enabled is true" .Values.securityContext.runAsUser  -}}
{{- $_ = required "securityContext.fsGroup is required when setting securityContext and enabled is true" .Values.securityContext.fsGroup  -}}
{{- if int .Values.securityContext.runAsUser | eq 0 -}}
{{- fail (dict "errorKey" "securityContext.runAsUser" "errorMessage" "\n\nInvalid . \nContainers cannot be run as root users." | toJson) -}}
{{- end -}}
{{- end -}}
